---
import Layout from "../layouts/Layout.astro";
import { checkTransactionStatus } from '../../api/payment/wompiService.js'
import OrderConfirmation from '../components/orders/OrderConfirmation.vue'

const idTransaction =  new URLSearchParams(Astro.url.searchParams).get('idTransaccion');
const getOrderStatus = await checkTransactionStatus(idTransaction);
const response = await getOrderStatus.json();

if (!response.esAprobada) {
   return Astro.redirect('/informacion-pago');
}
---

<Layout title={'Confirmacion'}>
    <OrderConfirmation client:load/>
</Layout>